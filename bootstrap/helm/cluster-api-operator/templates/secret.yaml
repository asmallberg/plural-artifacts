{{- if .Values.secret.create -}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "cluster-api-operator-plural.secretName" . }}
type: Opaque
data:
    {{- range $key, $value := .Values.secret.data }}
    {{ $key }}: {{ $value | b64enc }}
    {{- end }}
    {{- if .Values.infrastructureProvider.aws.enabled }}
    AWS_B64ENCODED_CREDENTIALS: {{ include "cluster-api-operator-plural.awsCredentialsValue" . }}
    {{- range $key, $value := .Values.infrastructureProvider.aws.secretData }}
    {{ $key }}: {{ $value | b64enc }}
    {{- end }}
    {{- if not .Values.secret.bootstrap }}
    {{- range $key, $value := .Values.infrastructureProvider.aws.credentials }}
    {{ $key }}: {{ $value | b64enc }}
    {{- end }}
    {{- end }}
    {{- end }}
{{- end }}
